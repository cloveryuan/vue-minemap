(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{143:function(t,e,n){},145:function(t,e,n){"use strict";var i=n(143);n.n(i).a},146:function(t,e,n){"use strict";n(21),n(144),n(22),n(23);var i=[];function a(t){return i.filter(function(e){return e.id===t})[0].mapInstace}var o={name:"MineMap",provide:function(){return{getMap:this.getMap}},props:{accessToken:{type:String,required:!0},solution:{type:[String,Number],required:!0},options:{type:Object,required:!0}},data:function(){return{isMapLoaded:!1}},mounted:function(){this.initMap()},beforeDestroy:function(){},destroyed:function(){this.rmMap()},methods:{initMap:function(){var t=this,e=e||window.minemap,n=this.accessToken,a=this.solution,o=this.options;e.accessToken=n,e.solution=a,this.rmMap(),this.isMapLoaded=!1,this.map=new e.Map(o),i.push({id:this.options.container,mapInstace:this.map}),this.map.on("load",function(){t.$emit("map-load",t.map),t.isMapLoaded=!0})},rmMap:function(){this.map&&(this.map.remove(),this.map=null,function(t){var e=null;i.forEach(function(n,i){n.id===t&&(e=i)}),i.splice(e,1)}(this.solution))},getMap:function(){return this.map}},watch:{solution:function(){this.initMap()}}},r=(n(145),n(0));n.d(e,"b",function(){return a});var s=Object(r.a)(o,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vue-minemap",attrs:{id:this.options.container}},[this._t("default")],2)},[],!1,null,"88a6b8fa",null);s.options.__file="MineMap.vue";e.a=s.exports},159:function(t,e,n){},160:function(t,e,n){},161:function(t,e,n){},170:function(t,e,n){"use strict";var i=n(159);n.n(i).a},171:function(t,e,n){"use strict";var i=n(160);n.n(i).a},174:function(t,e,n){"use strict";var i=n(161);n.n(i).a},177:function(t,e,n){"use strict";n.r(e);n(23),n(21),n(50);var i={name:"MMSource",inject:["getMap"],provide:function(){return{sourceId:this.id}},data:function(){return{isSourceLoaded:!1}},props:{id:{type:String,required:!0},options:{type:Object,required:!0},mapInstace:{type:Object}},mounted:function(){var t=this;"MineMap"===this.$parent.$options.name?(this.$parent.$on("map-load",function(e){t.map=e,t.addSource()}),this.$parent.isMapLoaded&&(this.map=this.getMap(),this.addSource())):(this.map=this.mapInstace,this.addSource())},beforeDestroy:function(){},destroyed:function(){this.rmSource()},methods:{addSource:function(){var t=this.id,e=this.options,n=this.map;n&&(n.getSource(t)&&n.removeSource(t),n.addSource(t,e),this.$emit("source-load",n),this.isSourceLoaded=!0)},rmSource:function(){var t=this.id,e=this.map;e&&e.removeSource(t)}},watch:{options:{deep:!0,handler:function(){this.rmSource(),this.addSource()}}}},a=(n(170),n(0)),o=Object(a.a)(i,function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default")],2)},[],!1,null,"65326650",null);o.options.__file="MMSource.vue";var r=o.exports,s=(n(17),n(24),n(14),n(22),{name:"MMLayer",inject:["sourceId","getMap"],props:{id:{type:String,required:!0},type:{type:String,required:!0},sourceLayer:{type:String,default:""},layout:{type:Object,default:null},paint:{type:Object,default:null},filter:{type:Array,default:null}},data:function(){return{}},mounted:function(){var t=this;this.$parent.$on("source-load",function(e){t.map=e,t.addLayer()}),this.$parent.isSourceLoaded&&(this.map=this.getMap,this.addLayer())},beforeDestroy:function(){this.rmLayer()},computed:{layerOptions:function(){var t=this,e={id:this.id,source:this.sourceId,type:this.type};return["paint","layout","filter"].forEach(function(n){t[n]&&(e[n]=t[n])}),this.sourceLayer&&(e["source-layer"]=this.sourceLayer),e}},methods:{addLayer:function(){var t=this.map,e=this.id,n=this.layerOptions;t&&(t.getLayer(e)&&this.rmLayer(),t.addLayer(n))},rmLayer:function(){var t=this.map;t&&t.removeLayer(this.id)}},watch:{layout:{deep:!0,handler:function(t,e){var n=this;this.$parent.isSourceLoaded?Object.keys(t).forEach(function(e){n.map.setLayoutProperty(n.id,e,t[e])}):this.$parent.$once("source-load",function(e){Object.keys(t).forEach(function(i){e.setLayoutProperty(n.id,i,t[i])})})}},paint:{deep:!0,handler:function(t,e){var n=this;this.$parent.isSourceLoaded?Object.keys(t).forEach(function(e){n.map.setPaintProperty(n.id,e,t[e])}):this.$parent.$once("source-load",function(e){Object.keys(t).forEach(function(i){e.setPaintProperty(n.id,i,t[i])})})}},filter:{deep:!0,handler:function(t,e){this.map.setFilter(this.id,this.filter)}}}}),c=(n(171),Object(a.a)(s,function(){var t=this.$createElement;return(this._self._c||t)("div")},[],!1,null,"65849f8f",null));c.options.__file="MMLayer.vue";var u=c.exports,d=n(146),p=n(172),l=n.n(p),h={name:"MoveLayer",data:function(){return{show:!0,id:0,mapProps:{accessToken:"e919a6f32ce242f5aec22652d9dc1fdb",solution:"7185",options:{container:"map",style:"//minedata.cn/service/solu/style/id/7185",center:[116.1866179,39.992559],zoom:9,minZoom:3,maxZoom:17}},layerList:[]}},mounted:function(){},components:{MMSource:r,MMLayer:u,MineMap:d.a,Vdrag:l.a},methods:{onDelClick:function(t){this.layerList=this.layerList.filter(function(e,n){return n!==t})},onDragEnd:function(){var t=this;this.show=!1,this.$nextTick(function(){t.show=!0})},onAdd:function(){var t=function(t){return parseInt(Math.random()*t)},e="rgb(".concat(t(255),",").concat(t(255),",").concat(t(255),")"),n=t(100),i=this.id++;this.layerList.push({sourceId:i+"",sourceOp:{type:"geojson",data:{type:"Point",coordinates:[116.1866179,39.992559]}},layerOp:{id:i+"",type:"circle",paint:{"circle-radius":n,"circle-color":e}}})},onInputChange:function(t,e){this.layerList[t].layerOp.paint["circle-radius"]=parseInt(e.target.value)}}},f=(n(174),Object(a.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"demo-container"},[n("MineMap",t._b({on:{click:function(t){},onload:function(t){}}},"MineMap",t.mapProps,!1),t._l(t.layerList,function(e,i){return t.show?n("MMSource",{key:e.sourceId,attrs:{id:e.sourceId,options:e.sourceOp}},[n("MMLayer",t._b({},"MMLayer",e.layerOp,!1))],1):t._e()})),t._v(" "),n("div",{staticClass:"action-panel"},[n("Vdrag",{staticClass:"layer-list",on:{end:t.onDragEnd},model:{value:t.layerList,callback:function(e){t.layerList=e},expression:"layerList"}},t._l(t.layerList,function(e,i){return n("div",{key:e.sourceId,style:{color:e.layerOp.paint["circle-color"]}},[n("div",{staticClass:"panel-row"},[t._v("\n          "+t._s(e.sourceId)+"\n          "),n("button",{on:{click:function(e){t.onDelClick(i)}}},[t._v("X")])]),t._v(" "),n("div",{staticClass:"panel-row"},[t._v("\n          radius: "),n("input",{attrs:{type:"text"},domProps:{value:e.layerOp.paint["circle-radius"]},on:{change:function(e){t.onInputChange(i,e)}}})])])})),t._v(" "),n("button",{staticClass:"add-layer",on:{click:t.onAdd}},[t._v("添加")])],1)],1)},[],!1,null,"4b55b735",null));f.options.__file="MoveLayer.vue";e.default=f.exports}}]);